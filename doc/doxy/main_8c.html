<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NETWORK ATTACKS FRAMEWORK: main.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NETWORK ATTACKS FRAMEWORK
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A NETwork Attacks framework. Making network attacks impact evaluation easier!</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('main_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;linux/sockios.h&gt;</code><br/>
<code>#include &lt;linux/wireless.h&gt;</code><br/>
<code>#include &lt;getopt.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &quot;defs.h&quot;</code><br/>
<code>#include &quot;debug.h&quot;</code><br/>
<code>#include &quot;timer_queue.h&quot;</code><br/>
<code>#include &quot;MA_params.h&quot;</code><br/>
<code>#include &quot;MA_aodv_socket.h&quot;</code><br/>
<code>#include &quot;MA_aodv_timeout.h&quot;</code><br/>
<code>#include &quot;k_route.h&quot;</code><br/>
<code>#include &quot;MA_routing_table.h&quot;</code><br/>
<code>#include &quot;MA_aodv_hello.h&quot;</code><br/>
<code>#include &quot;MA_nl.h&quot;</code><br/>
</div>
<p><a href="main_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>callback</b></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#abc71e1c953fb72e8943b8626e15716e1">CALLBACK_FUNCS</a>&#160;&#160;&#160;5</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ad2c1f41ec0950813bbc28490e903269f">usage</a> (int status)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a8f172953b4bf81bfa0e5ced4c26631db">set_kernel_options</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a4194d07b53018aecc963506e03796b8c">find_default_gw</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct sockaddr_in *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aeda41612c8ad541671f583dfb63f8574">get_if_info</a> (char *ifname, int type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a2a74ba48855a88762b22fd3bc4e59db6">attach_callback_func</a> (int fd, <a class="el" href="NA__defs__aodv_8h.html#a8ecf64ad167cc6925826db91efc8c28f">callback_func_t</a> func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a8dc54036ce4b1205832dc36caf2f55bf">load_modules</a> (char *ifname)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ac26a8abe68d825d705781dd2be20b7c8">remove_modules</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a3005d346672be9ca638b2bdc0138e9ac">host_init</a> (char *ifname)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a4e98e29d6f905cae86d76674f95d6609">signal_handler</a> (int type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ae55eec632e369a4afc18e804bae8f3e4">unidir_hack</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a6be52079b3b26f9986ccdddfbca964e6">internet_gw_mode</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aa10c5b3c1ff250cd241fe589fdf92253">receive_n_hellos</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#afaade160707f6edb3cd48ee8d3900acf">qual_threshold</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a83fc801f45ea0b9e34e374f86a8a987c">gw_prefix</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structtimer.html">timer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a1b01d3369a884952b1b133647b6f8972">active_route_timeout</a> = <a class="el" href="NA__params_8h.html#aee301589e9a61e7ac1b97da56f602a66">ACTIVE_ROUTE_TIMEOUT_HELLO</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ab0e1b854de69ed4c072e72f977599c95">ttl_start</a> = <a class="el" href="NA__params_8h.html#a85895a7aa8febd51e264593000ed7c4c">TTL_START_HELLO</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ab2f352af0fd66527b61319af50f5f50a">delete_period</a> = <a class="el" href="NA__params_8h.html#ac9cc85aa90ba4bc5a62071f6fdd31d5a">DELETE_PERIOD_HELLO</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct option&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a94965649155359a4c4eb047af782bf22">longopts</a> []</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="abc71e1c953fb72e8943b8626e15716e1"></a><!-- doxytag: member="main.c::CALLBACK_FUNCS" ref="abc71e1c953fb72e8943b8626e15716e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="main_8c.html#abc71e1c953fb72e8943b8626e15716e1">CALLBACK_FUNCS</a>&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00277">277</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a2a74ba48855a88762b22fd3bc4e59db6"></a><!-- doxytag: member="main.c::attach_callback_func" ref="a2a74ba48855a88762b22fd3bc4e59db6" args="(int fd, callback_func_t func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__defs__aodv_8h.html#a2a74ba48855a88762b22fd3bc4e59db6">attach_callback_func</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="NA__defs__aodv_8h.html#a8ecf64ad167cc6925826db91efc8c28f">callback_func_t</a>&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00285">285</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (nr_callbacks &gt;= <a class="code" href="main_8c.html#abc71e1c953fb72e8943b8626e15716e1">CALLBACK_FUNCS</a>) {
        fprintf(stderr, <span class="stringliteral">&quot;callback attach limit reached!!\n&quot;</span>);
        exit(-1);
    }
    callbacks[nr_callbacks].fd = fd;
    callbacks[nr_callbacks].func = func;
    nr_callbacks++;
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4194d07b53018aecc963506e03796b8c"></a><!-- doxytag: member="main.c::find_default_gw" ref="a4194d07b53018aecc963506e03796b8c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a4194d07b53018aecc963506e03796b8c">find_default_gw</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00220">220</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    FILE *route;
    <span class="keywordtype">char</span> buf[100], *l;

    route = fopen(<span class="stringliteral">&quot;/proc/net/route&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);

    <span class="keywordflow">if</span> (route == NULL) {
        perror(<span class="stringliteral">&quot;open /proc/net/route&quot;</span>);
        exit(-1);
    }

    <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), route)) {
        l = strtok(buf, <span class="stringliteral">&quot; \t&quot;</span>);
        l = strtok(NULL, <span class="stringliteral">&quot; \t&quot;</span>);
        <span class="keywordflow">if</span> (l != NULL) {
            <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;00000000&quot;</span>, l) == 0) {
                l = strtok(NULL, <span class="stringliteral">&quot; \t&quot;</span>);
                l = strtok(NULL, <span class="stringliteral">&quot; \t&quot;</span>);
                <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;0003&quot;</span>, l) == 0) {
                    fclose(route);
                    <span class="keywordflow">return</span> 1;
                }
            }
        }
    }
    fclose(route);
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aeda41612c8ad541671f583dfb63f8574"></a><!-- doxytag: member="main.c::get_if_info" ref="aeda41612c8ad541671f583dfb63f8574" args="(char *ifname, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct sockaddr_in* <a class="el" href="main_8c.html#aeda41612c8ad541671f583dfb63f8574">get_if_info</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ifname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00253">253</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> skfd;
    <span class="keyword">struct </span>sockaddr_in *ina;
    <span class="keyword">static</span> <span class="keyword">struct </span>ifreq ifr;

    <span class="comment">/* Get address of interface... */</span>
    skfd = socket(AF_INET, SOCK_DGRAM, 0);

    strcpy(ifr.ifr_name, ifname);
    <span class="keywordflow">if</span> (ioctl(skfd, type, &amp;ifr) &lt; 0) {
        <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_ERR, errno, __FUNCTION__,
             <span class="stringliteral">&quot;Could not get address of %s &quot;</span>, ifname);
        close(skfd);
        <span class="keywordflow">return</span> NULL;
    } <span class="keywordflow">else</span> {
        ina = (<span class="keyword">struct </span>sockaddr_in *) &amp;ifr.ifr_addr;
        close(skfd);
        <span class="keywordflow">return</span> ina;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3005d346672be9ca638b2bdc0138e9ac"></a><!-- doxytag: member="main.c::host_init" ref="a3005d346672be9ca638b2bdc0138e9ac" args="(char *ifname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="main_8c.html#a3005d346672be9ca638b2bdc0138e9ac">host_init</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ifname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00348">348</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>sockaddr_in *ina;
    <span class="keywordtype">char</span> buf[1024], tmp_ifname[IFNAMSIZ],
        ifnames[(IFNAMSIZ + 1) * <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>], *iface;
    <span class="keyword">struct </span>ifconf ifc;
    <span class="keyword">struct </span>ifreq ifreq, *ifr;
    <span class="keywordtype">int</span> i, iw_sock, if_sock = 0;

    memset(&amp;<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structhost__info.html">host_info</a>));
    memset(<a class="code" href="NA__defs__aodv_8h.html#aadc3440bff34bbc102e29a41aa256e18">dev_indices</a>, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) * <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>);

    <span class="keywordflow">if</span> (!ifname) {
        <span class="comment">/* No interface was given... search for first wireless. */</span>
        iw_sock = socket(PF_INET, SOCK_DGRAM, 0);
        ifc.ifc_len = <span class="keyword">sizeof</span>(buf);
        ifc.ifc_buf = buf;
        <span class="keywordflow">if</span> (ioctl(iw_sock, SIOCGIFCONF, &amp;ifc) &lt; 0) {
            fprintf(stderr, <span class="stringliteral">&quot;Could not get wireless info\n&quot;</span>);
            exit(-1);
        }
        ifr = ifc.ifc_req;
        <span class="keywordflow">for</span> (i = ifc.ifc_len / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ifreq); i &gt;= 0; i--, ifr++) {
            <span class="keyword">struct </span>iwreq req;

            strcpy(req.ifr_name, ifr-&gt;ifr_name);
            <span class="keywordflow">if</span> (ioctl(iw_sock, SIOCGIWNAME, &amp;req) &gt;= 0) {
                strcpy(tmp_ifname, ifr-&gt;ifr_name);
                <span class="keywordflow">break</span>;
            }
        }
        <span class="comment">/* Did we find a wireless interface? */</span>
        <span class="keywordflow">if</span> (!strlen(tmp_ifname)) {
            fprintf(stderr, <span class="stringliteral">&quot;\nCould not find a wireless interface!\n&quot;</span>);
            fprintf(stderr, <span class="stringliteral">&quot;Use -i &lt;interface&gt; to override...\n\n&quot;</span>);
            exit(-1);
        }
        strcpy(ifreq.ifr_name, tmp_ifname);
        <span class="keywordflow">if</span> (ioctl(iw_sock, SIOCGIFINDEX, &amp;ifreq) &lt; 0) {
            <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_ERR, errno, __FUNCTION__,
                 <span class="stringliteral">&quot;Could not get index of %s&quot;</span>, tmp_ifname);
            close(if_sock);
            exit(-1);
        }
        close(iw_sock);

        ifname = tmp_ifname;

        <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_NOTICE, 0, __FUNCTION__,
             <span class="stringliteral">&quot;Attaching to %s, override with -i &lt;if1,if2,...&gt;.&quot;</span>, tmp_ifname);
    }

    strcpy(ifnames, ifname);

    <span class="comment">/* Intitialize the local sequence number an rreq_id to zero */</span>
    <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#a42c045dee154a8fd24c7081602aff457">seqno</a> = 1;
    <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#ad7cd479f367ded9d8884f1f8c8dd5f02">rreq_id</a> = 0;

    <span class="comment">/* Zero interfaces enabled so far... */</span>
    <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a> = 0;

    gettimeofday(&amp;<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#ae606abd6c910cacad35a403eef8b1796">bcast_time</a>, NULL);

    <span class="comment">/* Find the indices of all interfaces to broadcast on... */</span>
    if_sock = socket(AF_INET, SOCK_DGRAM, 0);

    iface = strtok(ifname, <span class="stringliteral">&quot;,&quot;</span>);

    <span class="comment">/* OK, now lookup interface information, and store it... */</span>
    <span class="keywordflow">do</span> {
        strcpy(ifreq.ifr_name, iface);
        <span class="keywordflow">if</span> (ioctl(if_sock, SIOCGIFINDEX, &amp;ifreq) &lt; 0) {
            <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_ERR, errno, __FUNCTION__, <span class="stringliteral">&quot;Could not get index of %s&quot;</span>,
                 iface);
            close(if_sock);
            exit(-1);
        }
        <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#af325a2d90f432c9fce1e19488e6b71bf">devs</a>[<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a>].<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a> = ifreq.ifr_ifindex;

        <a class="code" href="NA__defs__aodv_8h.html#aadc3440bff34bbc102e29a41aa256e18">dev_indices</a>[<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a>++] = ifreq.ifr_ifindex;

        strcpy(<a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(ifreq.ifr_ifindex).ifname, iface);

        <span class="comment">/* Get IP-address of interface... */</span>
        ina = <a class="code" href="main_8c.html#aeda41612c8ad541671f583dfb63f8574">get_if_info</a>(iface, SIOCGIFADDR);
        <span class="keywordflow">if</span> (ina == NULL)
            exit(-1);

        <a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(ifreq.ifr_ifindex).ipaddr = ina-&gt;sin_addr;

        <span class="comment">/* Get netmask of interface... */</span>
        ina = <a class="code" href="main_8c.html#aeda41612c8ad541671f583dfb63f8574">get_if_info</a>(iface, SIOCGIFNETMASK);
        <span class="keywordflow">if</span> (ina == NULL)
            exit(-1);

        <a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(ifreq.ifr_ifindex).netmask = ina-&gt;sin_addr;

        ina = <a class="code" href="main_8c.html#aeda41612c8ad541671f583dfb63f8574">get_if_info</a>(iface, SIOCGIFBRDADDR);
        <span class="keywordflow">if</span> (ina == NULL)
            exit(-1);

        <a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(ifreq.ifr_ifindex).broadcast = ina-&gt;sin_addr;

        <a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(ifreq.ifr_ifindex).enabled = 1;

        <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a> &gt;= <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>)
            <span class="keywordflow">break</span>;

    } <span class="keywordflow">while</span> ((iface = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>)));

    close(if_sock);

    <span class="comment">/* Load kernel modules */</span>
    <a class="code" href="main_8c.html#a8dc54036ce4b1205832dc36caf2f55bf">load_modules</a>(ifnames);

    <span class="comment">/* Enable IP forwarding and set other kernel options... */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a8f172953b4bf81bfa0e5ced4c26631db">set_kernel_options</a>() &lt; 0) {
        fprintf(stderr, <span class="stringliteral">&quot;Could not set kernel options!\n&quot;</span>);
        exit(-1);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8dc54036ce4b1205832dc36caf2f55bf"></a><!-- doxytag: member="main.c::load_modules" ref="a8dc54036ce4b1205832dc36caf2f55bf" args="(char *ifname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="main_8c.html#a8dc54036ce4b1205832dc36caf2f55bf">load_modules</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ifname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00301">301</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>stat st;
    <span class="keywordtype">char</span> buf[1024], *l = NULL;
    <span class="keywordtype">int</span> found = 0;
    FILE *m;

    memset(buf, <span class="charliteral">&#39;\0&#39;</span>, 64);

    <span class="keywordflow">if</span> (stat(<span class="stringliteral">&quot;./kaodv.ko&quot;</span>, &amp;st) == 0)
        sprintf(buf, <span class="stringliteral">&quot;/sbin/insmod kaodv.ko ifname=%s &amp;&gt;/dev/null&quot;</span>, ifname);
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat(<span class="stringliteral">&quot;./kaodv.o&quot;</span>, &amp;st) == 0)
        sprintf(buf, <span class="stringliteral">&quot;/sbin/insmod kaodv.o ifname=%s &amp;&gt;/dev/null&quot;</span>, ifname);
    <span class="keywordflow">else</span>
        sprintf(buf, <span class="stringliteral">&quot;/sbin/modprobe kaodv ifname=%s &amp;&gt;/dev/null&quot;</span>, ifname);

    system(buf);

    usleep(100000);

    <span class="comment">/* Check result */</span>
    m = fopen(<span class="stringliteral">&quot;/proc/modules&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);
    <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), m)) {
        l = strtok(buf, <span class="stringliteral">&quot; \t&quot;</span>);
        <span class="keywordflow">if</span> (!strcmp(l, <span class="stringliteral">&quot;kaodv&quot;</span>))
            found++;
        <span class="keywordflow">if</span> (!strcmp(l, <span class="stringliteral">&quot;ipchains&quot;</span>)) {
            fprintf(stderr,
                    <span class="stringliteral">&quot;The ipchains kernel module is loaded and prevents AODV-UU from functioning properly.\n&quot;</span>);
            exit(-1);
        }
    }
    fclose(m);

    <span class="keywordflow">if</span> (found &lt; 1) {
        fprintf(stderr,
                <span class="stringliteral">&quot;A kernel module could not be loaded, check your installation... %d\n&quot;</span>,
                found);
        exit(-1);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a><!-- doxytag: member="main.c::main" ref="a3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00486">486</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> *ifname = NULL; <span class="comment">/* Name of interface to attach to */</span>
    fd_set rfds, readers;
    <span class="keywordtype">int</span> n, nfds = 0, i;
    <span class="keywordtype">int</span> daemonize = 0;
    <span class="keyword">struct </span>timeval *timeout;

    <span class="comment">/* Remember the name of the executable... */</span>
    <a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a> = strrchr(argv[0], <span class="charliteral">&#39;/&#39;</span>);

    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>)
        <a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>++;
    <span class="keywordflow">else</span>
        <a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a> = argv[0];

    <span class="comment">/* Use debug output as default */</span>
    <a class="code" href="NA__debug__aodv_8h.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = 1;

    <span class="comment">/* Parse command line: */</span>

    <span class="keywordflow">while</span> (1) {
        <span class="keywordtype">int</span> opt;

        opt = getopt_long(argc, argv, <span class="stringliteral">&quot;i:fjln:dghoq:r:s:uwxDLRV&quot;</span>, <a class="code" href="main_8c.html#a94965649155359a4c4eb047af782bf22">longopts</a>, 0);

        <span class="keywordflow">if</span> (opt == EOF)
            <span class="keywordflow">break</span>;

        <span class="keywordflow">switch</span> (opt) {
        <span class="keywordflow">case</span> 0:
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:
            <a class="code" href="NA__debug__aodv_8h.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = 0;
            daemonize = 1;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:
            <a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> = 1;
            <a class="code" href="main_8c.html#a1b01d3369a884952b1b133647b6f8972">active_route_timeout</a> = <a class="code" href="NA__params_8h.html#a42ed2e9e7d24d26a1d0092373d4de678">ACTIVE_ROUTE_TIMEOUT_LLF</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:
            <a class="code" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a> = !<a class="code" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:
            ifname = optarg;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;j&#39;</span>:
            <a class="code" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a> = !<a class="code" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:
            <a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a> = !<a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:
            <span class="keywordflow">if</span> (optarg &amp;&amp; isdigit(*optarg)) {
                <a class="code" href="main_8c.html#aa10c5b3c1ff250cd241fe589fdf92253">receive_n_hellos</a> = atoi(optarg);
                <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#aa10c5b3c1ff250cd241fe589fdf92253">receive_n_hellos</a> &lt; 2) {
                    fprintf(stderr, <span class="stringliteral">&quot;-n should be at least 2!\n&quot;</span>);
                    exit(-1);
                }
            }
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:
            <a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a> = !<a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>:
            <span class="keywordflow">if</span> (optarg &amp;&amp; isdigit(*optarg))
                <a class="code" href="main_8c.html#afaade160707f6edb3cd48ee8d3900acf">qual_threshold</a> = atoi(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:
            <span class="keywordflow">if</span> (optarg &amp;&amp; isdigit(*optarg))
                <a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a> = atof(optarg) * 1000;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:
            <a class="code" href="main_8c.html#ae55eec632e369a4afc18e804bae8f3e4">unidir_hack</a> = !<a class="code" href="main_8c.html#ae55eec632e369a4afc18e804bae8f3e4">unidir_hack</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:
            <a class="code" href="main_8c.html#a6be52079b3b26f9986ccdddfbca964e6">internet_gw_mode</a> = !<a class="code" href="main_8c.html#a6be52079b3b26f9986ccdddfbca964e6">internet_gw_mode</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>:
            <a class="code" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a> = !<a class="code" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
            <a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> = !<a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>:
            <a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> = !<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:
            <a class="code" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a> = !<a class="code" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>:
            printf
                (<span class="stringliteral">&quot;\nAODV-UU v%s, %s © Uppsala University &amp; Ericsson AB.\nAuthor: Erik Nordström, &lt;erik.nordstrom@it.uu.se&gt;\n\n&quot;</span>,
                 <a class="code" href="NA__defs__aodv_8h.html#a7b2e844636a8cd9996ffbaf2714b8dfa">AODV_UU_VERSION</a>, <a class="code" href="NA__defs__aodv_8h.html#a4e654ea0f2dda91f1a96ddfba37a1bbc">DRAFT_VERSION</a>);
            exit(0);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:
        <span class="keywordflow">case</span> <span class="charliteral">&#39;:&#39;</span>:
            exit(0);
        <span class="keywordflow">default</span>:
            <a class="code" href="main_8c.html#ad2c1f41ec0950813bbc28490e903269f">usage</a>(0);
        }
    }
    <span class="comment">/* Check that we are running as root */</span>
    <span class="keywordflow">if</span> (geteuid() != 0) {
        fprintf(stderr, <span class="stringliteral">&quot;must be root\n&quot;</span>);
        exit(1);
    }

    <span class="comment">/* Detach from terminal */</span>
    <span class="keywordflow">if</span> (daemonize) {
        <span class="keywordflow">if</span> (fork() != 0)
            exit(0);
        <span class="comment">/* Close stdin, stdout and stderr... */</span>
        <span class="comment">/*  close(0); */</span>
        close(1);
        close(2);
        setsid();
    }
    <span class="comment">/* Make sure we cleanup at exit... */</span>
    atexit((<span class="keywordtype">void</span> *) &amp;cleanup);

    <span class="comment">/* Initialize data structures and services... */</span>
    <a class="code" href="NA__routing__table_8cc.html#af55d0c061f4060fa7df11209b4b0fdbf">rt_table_init</a>();
    <a class="code" href="NA__debug__aodv_8cc.html#aecfc084a466c1e43aa3fc757e1ba3818">log_init</a>();
    <span class="comment">/*   packet_queue_init(); */</span>
    <a class="code" href="main_8c.html#a3005d346672be9ca638b2bdc0138e9ac">host_init</a>(ifname);
    <span class="comment">/*   packet_input_init(); */</span>
    <a class="code" href="NA__nl_8c.html#a93928ee1bf6f46b1fc0fc40a6e5ff5ca">nl_init</a>();
    <a class="code" href="NA__nl_8c.html#a51ae28ace2789c617629268669a07875">nl_send_conf_msg</a>();
    <a class="code" href="NA__aodv__socket_8cc.html#a46b63fe67cacd677eb832c40f1466dc0">aodv_socket_init</a>();
<span class="preprocessor">#ifdef LLFEEDBACK</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a>) {
        <a class="code" href="NA__llf_8c.html#a3d076789d9720a36cbfb8d81915d0cfc">llf_init</a>();
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="comment">/* Catch SIGHUP, SIGINT and SIGTERM type signals */</span>
    signal(SIGHUP, <a class="code" href="main_8c.html#a4e98e29d6f905cae86d76674f95d6609">signal_handler</a>);
    signal(SIGINT, <a class="code" href="main_8c.html#a4e98e29d6f905cae86d76674f95d6609">signal_handler</a>);
    signal(SIGTERM, <a class="code" href="main_8c.html#a4e98e29d6f905cae86d76674f95d6609">signal_handler</a>);

    <span class="comment">/* Only capture segmentation faults when we are not debugging... */</span>
<span class="preprocessor">#ifndef DEBUG</span>
<span class="preprocessor"></span>    signal(SIGSEGV, <a class="code" href="main_8c.html#a4e98e29d6f905cae86d76674f95d6609">signal_handler</a>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="comment">/* Set sockets to watch... */</span>
    FD_ZERO(&amp;readers);
    <span class="keywordflow">for</span> (i = 0; i &lt; nr_callbacks; i++) {
        FD_SET(callbacks[i].fd, &amp;readers);
        <span class="keywordflow">if</span> (callbacks[i].fd &gt;= nfds)
            nfds = callbacks[i].fd + 1;
    }

    <span class="comment">/* Set the wait on reboot timer... */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a>) {
        <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;<a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>, <a class="code" href="NA__aodv__timeout_8cc.html#a5ed6c5e23736c182228b2b5c3382c5ad">wait_on_reboot_timeout</a>, &amp;<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;<a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>, <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
        <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_NOTICE, 0, __FUNCTION__,
             <span class="stringliteral">&quot;In wait on reboot for %d milliseconds. Disable with \&quot;-D\&quot;.&quot;</span>,
             <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
    }

    <span class="comment">/* Schedule the first Hello */</span>
    <span class="keywordflow">if</span> (!<a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a> &amp;&amp; !<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a>)
        <a class="code" href="NA__aodv__hello_8cc.html#ab6bcab8fcfe60a3dfdb059c4f96c402b">hello_start</a>();

    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a>)
        <a class="code" href="NA__debug__aodv_8cc.html#ad648b58f4087c21b60e97762f4d87bf8">log_rt_table_init</a>();

    <span class="keywordflow">while</span> (1) {
        memcpy((<span class="keywordtype">char</span> *) &amp;rfds, (<span class="keywordtype">char</span> *) &amp;readers, <span class="keyword">sizeof</span>(rfds));

        timeout = <a class="code" href="NA__timer__queue__aodv_8cc.html#a07af83c3d8ae6d413f20d06e28a0d10f">timer_age_queue</a>();

        <span class="keywordflow">if</span> ((n = select(nfds, &amp;rfds, NULL, NULL, timeout)) &lt; 0) {
            <span class="keywordflow">if</span> (errno != EINTR)
                <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_WARNING, errno, __FUNCTION__,
                     <span class="stringliteral">&quot;Failed select (main loop)&quot;</span>);
            <span class="keywordflow">continue</span>;
        }

        <span class="keywordflow">if</span> (n &gt; 0) {
            <span class="keywordflow">for</span> (i = 0; i &lt; nr_callbacks; i++) {
                <span class="keywordflow">if</span> (FD_ISSET(callbacks[i].fd, &amp;rfds)) {
                    <span class="comment">/* We don&#39;t want any timer SIGALRM&#39;s while executing the</span>
<span class="comment">                       callback functions, therefore we block the timer... */</span>
                    (*callbacks[i].func) (callbacks[i].fd);
                }
            }
        }
    }                           <span class="comment">/* Main loop */</span>
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac26a8abe68d825d705781dd2be20b7c8"></a><!-- doxytag: member="main.c::remove_modules" ref="ac26a8abe68d825d705781dd2be20b7c8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="main_8c.html#ac26a8abe68d825d705781dd2be20b7c8">remove_modules</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00343">343</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    system(<span class="stringliteral">&quot;/sbin/rmmod kaodv &amp;&gt;/dev/null&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8f172953b4bf81bfa0e5ced4c26631db"></a><!-- doxytag: member="main.c::set_kernel_options" ref="a8f172953b4bf81bfa0e5ced4c26631db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a8f172953b4bf81bfa0e5ced4c26631db">set_kernel_options</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00131">131</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> i, fd = -1;
    <span class="keywordtype">char</span> on = <span class="charliteral">&#39;1&#39;</span>;
    <span class="keywordtype">char</span> off = <span class="charliteral">&#39;0&#39;</span>;
    <span class="keywordtype">char</span> command[64];

    <span class="keywordflow">if</span> ((fd = open(<span class="stringliteral">&quot;/proc/sys/net/ipv4/ip_forward&quot;</span>, O_WRONLY)) &lt; 0)
        <span class="keywordflow">return</span> -1;
    <span class="keywordflow">if</span> (write(fd, &amp;on, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
    close(fd);

    <span class="keywordflow">if</span> ((fd = open(<span class="stringliteral">&quot;/proc/sys/net/ipv4/route/max_delay&quot;</span>, O_WRONLY)) &lt; 0)
        <span class="keywordflow">return</span> -1;
    <span class="keywordflow">if</span> (write(fd, &amp;off, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
    close(fd);

    <span class="keywordflow">if</span> ((fd = open(<span class="stringliteral">&quot;/proc/sys/net/ipv4/route/min_delay&quot;</span>, O_WRONLY)) &lt; 0)
        <span class="keywordflow">return</span> -1;
    <span class="keywordflow">if</span> (write(fd, &amp;off, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
    close(fd);

    <span class="comment">/* Disable ICMP redirects on all interfaces: */</span>

    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>; i++) {
        <span class="keywordflow">if</span> (!<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).enabled)
            <span class="keywordflow">continue</span>;

        memset(command, <span class="charliteral">&#39;\0&#39;</span>, 64);
        sprintf(command, <span class="stringliteral">&quot;/proc/sys/net/ipv4/conf/%s/send_redirects&quot;</span>,
                <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifname);
        <span class="keywordflow">if</span> ((fd = open(command, O_WRONLY)) &lt; 0)
            <span class="keywordflow">return</span> -1;
        <span class="keywordflow">if</span> (write(fd, &amp;off, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
        close(fd);
        memset(command, <span class="charliteral">&#39;\0&#39;</span>, 64);
        sprintf(command, <span class="stringliteral">&quot;/proc/sys/net/ipv4/conf/%s/accept_redirects&quot;</span>,
                <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifname);
        <span class="keywordflow">if</span> ((fd = open(command, O_WRONLY)) &lt; 0)
            <span class="keywordflow">return</span> -1;
        <span class="keywordflow">if</span> (write(fd, &amp;off, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
        close(fd);
    }
    memset(command, <span class="charliteral">&#39;\0&#39;</span>, 64);
    sprintf(command, <span class="stringliteral">&quot;/proc/sys/net/ipv4/conf/all/send_redirects&quot;</span>);
    <span class="keywordflow">if</span> ((fd = open(command, O_WRONLY)) &lt; 0)
        <span class="keywordflow">return</span> -1;
    <span class="keywordflow">if</span> (write(fd, &amp;off, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
    close(fd);


    memset(command, <span class="charliteral">&#39;\0&#39;</span>, 64);
    sprintf(command, <span class="stringliteral">&quot;/proc/sys/net/ipv4/conf/all/accept_redirects&quot;</span>);
    <span class="keywordflow">if</span> ((fd = open(command, O_WRONLY)) &lt; 0)
        <span class="keywordflow">return</span> -1;
    <span class="keywordflow">if</span> (write(fd, &amp;off, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)) &lt; 0)
    {
        close(fd);
        <span class="keywordflow">return</span> -1;
    }
    close(fd);

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4e98e29d6f905cae86d76674f95d6609"></a><!-- doxytag: member="main.c::signal_handler" ref="a4e98e29d6f905cae86d76674f95d6609" args="(int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="main_8c.html#a4e98e29d6f905cae86d76674f95d6609">signal_handler</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00471">471</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{

    <span class="keywordflow">switch</span> (type) {
    <span class="keywordflow">case</span> SIGSEGV:
        <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_ERR, 0, __FUNCTION__, <span class="stringliteral">&quot;SEGMENTATION FAULT!!!! Exiting!!! &quot;</span>
             <span class="stringliteral">&quot;To get a core dump, compile with DEBUG option.&quot;</span>);
    <span class="keywordflow">case</span> SIGINT:
    <span class="keywordflow">case</span> SIGHUP:
    <span class="keywordflow">case</span> SIGTERM:
    <span class="keywordflow">default</span>:
        exit(0);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad2c1f41ec0950813bbc28490e903269f"></a><!-- doxytag: member="main.c::usage" ref="ad2c1f41ec0950813bbc28490e903269f" args="(int status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="main_8c.html#ad2c1f41ec0950813bbc28490e903269f">usage</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00097">97</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (status != 0) {
        fprintf(stderr, <span class="stringliteral">&quot;Try `%s --help&#39; for more information.\n&quot;</span>, <a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);
        exit(status);
    }

    printf
        (<span class="stringliteral">&quot;\nUsage: %s [-dghjlouwxLDRV] [-i if0,if1,..] [-r N] [-n N] [-q THR]\n\n&quot;</span>
         <span class="stringliteral">&quot;-d, --daemon            Daemon mode, i.e. detach from the console.\n&quot;</span>
         <span class="stringliteral">&quot;-g, --force-gratuitous  Force the gratuitous flag to be set on all RREQ&#39;s.\n&quot;</span>
         <span class="stringliteral">&quot;-h, --help              This information.\n&quot;</span>
         <span class="stringliteral">&quot;-i, --interface         Network interfaces to attach to. Defaults to first\n&quot;</span>
         <span class="stringliteral">&quot;                        wireless interface.\n&quot;</span>
         <span class="stringliteral">&quot;-j, --hello-jitter      Toggle hello jittering (default ON).\n&quot;</span>
         <span class="stringliteral">&quot;-l, --log               Log debug output to %s.\n&quot;</span>
         <span class="stringliteral">&quot;-o, --opt-hellos        Send HELLOs only when forwarding data (experimental).\n&quot;</span>
         <span class="stringliteral">&quot;-r, --log-rt-table      Log routing table to %s every N secs.\n&quot;</span>
         <span class="stringliteral">&quot;-n, --n-hellos          Receive N hellos from host before treating as neighbor.\n&quot;</span>
         <span class="stringliteral">&quot;-u, --unidir-hack       Detect and avoid unidirectional links (experimental).\n&quot;</span>
         <span class="stringliteral">&quot;-w, --gateway-mode      Enable experimental Internet gateway support.\n&quot;</span>
         <span class="stringliteral">&quot;-x, --no-expanding-ring Disable expanding ring search for RREQs.\n&quot;</span>
         <span class="stringliteral">&quot;-D, --no-worb           Disable 15 seconds wait on reboot delay.\n&quot;</span>
         <span class="stringliteral">&quot;-L, --local-repair      Enable local repair.\n&quot;</span>
         <span class="stringliteral">&quot;-f, --llfeedback        Enable link layer feedback.\n&quot;</span>
         <span class="stringliteral">&quot;-R, --rate-limit        Toggle rate limiting of RREQs and RERRs (default ON).\n&quot;</span>
         <span class="stringliteral">&quot;-q, --quality-threshold Set a minimum signal quality threshold for control packets.\n&quot;</span>
         <span class="stringliteral">&quot;-V, --version           Show version.\n\n&quot;</span>
         <span class="stringliteral">&quot;Erik Nordström, &lt;erik.nordstrom@it.uu.se&gt;\n\n&quot;</span>,
         <a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, <a class="code" href="NA__defs__aodv_8h.html#a079d9066624c0b522e8878173a4dd473">AODV_LOG_PATH</a>, <a class="code" href="NA__defs__aodv_8h.html#a1e177a00abe19b7498857bd26091a10d">AODV_RT_LOG_PATH</a>);

    exit(status);
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a1b01d3369a884952b1b133647b6f8972"></a><!-- doxytag: member="main.c::active_route_timeout" ref="a1b01d3369a884952b1b133647b6f8972" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__nl_8c.html#a1b01d3369a884952b1b133647b6f8972">active_route_timeout</a> = <a class="el" href="NA__params_8h.html#aee301589e9a61e7ac1b97da56f602a66">ACTIVE_ROUTE_TIMEOUT_HELLO</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00069">69</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab2f352af0fd66527b61319af50f5f50a"></a><!-- doxytag: member="main.c::delete_period" ref="ab2f352af0fd66527b61319af50f5f50a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#ab2f352af0fd66527b61319af50f5f50a">delete_period</a> = <a class="el" href="NA__params_8h.html#ac9cc85aa90ba4bc5a62071f6fdd31d5a">DELETE_PERIOD_HELLO</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00071">71</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a09464654a5c100dc4840caefec4672b0"></a><!-- doxytag: member="main.c::expanding_ring_search" ref="a09464654a5c100dc4840caefec4672b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00054">54</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a83fc801f45ea0b9e34e374f86a8a987c"></a><!-- doxytag: member="main.c::gw_prefix" ref="a83fc801f45ea0b9e34e374f86a8a987c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a83fc801f45ea0b9e34e374f86a8a987c">gw_prefix</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00065">65</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5195b41adb4586d2ad897d08ebb3dfad"></a><!-- doxytag: member="main.c::hello_jittering" ref="a5195b41adb4586d2ad897d08ebb3dfad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00058">58</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6be52079b3b26f9986ccdddfbca964e6"></a><!-- doxytag: member="main.c::internet_gw_mode" ref="a6be52079b3b26f9986ccdddfbca964e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__nl_8c.html#a6be52079b3b26f9986ccdddfbca964e6">internet_gw_mode</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00055">55</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a20ce58c799d3953a9d57e6c3f8910633"></a><!-- doxytag: member="main.c::llfeedback" ref="a20ce58c799d3953a9d57e6c3f8910633" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__nl_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00064">64</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab289d12fed7e29d1431a3206d813170c"></a><!-- doxytag: member="main.c::local_repair" ref="ab289d12fed7e29d1431a3206d813170c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00056">56</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="afa6334ccb70fdb244e4ac3f256241bca"></a><!-- doxytag: member="main.c::log_to_file" ref="afa6334ccb70fdb244e4ac3f256241bca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00050">50</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a94965649155359a4c4eb047af782bf22"></a><!-- doxytag: member="main.c::longopts" ref="a94965649155359a4c4eb047af782bf22" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct option <a class="el" href="main_8c.html#a94965649155359a4c4eb047af782bf22">longopts</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    {<span class="stringliteral">&quot;interface&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;i&#39;</span>},
    {<span class="stringliteral">&quot;hello-jitter&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;j&#39;</span>},
    {<span class="stringliteral">&quot;log&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;l&#39;</span>},
    {<span class="stringliteral">&quot;n-hellos&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;n&#39;</span>},
    {<span class="stringliteral">&quot;daemon&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;d&#39;</span>},
    {<span class="stringliteral">&quot;force-gratuitous&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;g&#39;</span>},
    {<span class="stringliteral">&quot;opt-hellos&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;o&#39;</span>},
    {<span class="stringliteral">&quot;quality-threshold&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;q&#39;</span>},
    {<span class="stringliteral">&quot;log-rt-table&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;r&#39;</span>},
    {<span class="stringliteral">&quot;unidir_hack&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;u&#39;</span>},
    {<span class="stringliteral">&quot;gateway-mode&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;w&#39;</span>},
    {<span class="stringliteral">&quot;help&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;h&#39;</span>},
    {<span class="stringliteral">&quot;no-expanding-ring&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;x&#39;</span>},
    {<span class="stringliteral">&quot;no-worb&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;D&#39;</span>},
    {<span class="stringliteral">&quot;local-repair&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;L&#39;</span>},
    {<span class="stringliteral">&quot;rate-limit&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;R&#39;</span>},
    {<span class="stringliteral">&quot;version&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;V&#39;</span>},
    {<span class="stringliteral">&quot;llfeedback&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;f&#39;</span>},
    {0}
}
</pre></div>
<p>Definition at line <a class="el" href="main_8c_source.html#l00075">75</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="aff2e4196aa2a66f42a9688b5dde5cbd8"></a><!-- doxytag: member="main.c::optimized_hellos" ref="aff2e4196aa2a66f42a9688b5dde5cbd8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00059">59</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab9e1449fd00c98428516f0b41eddcb10"></a><!-- doxytag: member="main.c::progname" ref="ab9e1449fd00c98428516f0b41eddcb10" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00061">61</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="afaade160707f6edb3cd48ee8d3900acf"></a><!-- doxytag: member="main.c::qual_threshold" ref="afaade160707f6edb3cd48ee8d3900acf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__nl_8c.html#afaade160707f6edb3cd48ee8d3900acf">qual_threshold</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00063">63</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3ecfcf4b066b9c242e176393695e38d0"></a><!-- doxytag: member="main.c::ratelimit" ref="a3ecfcf4b066b9c242e176393695e38d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00060">60</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa10c5b3c1ff250cd241fe589fdf92253"></a><!-- doxytag: member="main.c::receive_n_hellos" ref="aa10c5b3c1ff250cd241fe589fdf92253" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#aa10c5b3c1ff250cd241fe589fdf92253">receive_n_hellos</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00057">57</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9114356a8b6ad57f39c4d50388776531"></a><!-- doxytag: member="main.c::rreq_gratuitous" ref="a9114356a8b6ad57f39c4d50388776531" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00053">53</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a10b915edc92aec7ca4584b10aacdb7e7"></a><!-- doxytag: member="main.c::rt_log_interval" ref="a10b915edc92aec7ca4584b10aacdb7e7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00051">51</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab0e1b854de69ed4c072e72f977599c95"></a><!-- doxytag: member="main.c::ttl_start" ref="ab0e1b854de69ed4c072e72f977599c95" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#ab0e1b854de69ed4c072e72f977599c95">ttl_start</a> = <a class="el" href="NA__params_8h.html#a85895a7aa8febd51e264593000ed7c4c">TTL_START_HELLO</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00070">70</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae55eec632e369a4afc18e804bae8f3e4"></a><!-- doxytag: member="main.c::unidir_hack" ref="ae55eec632e369a4afc18e804bae8f3e4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="main_8c.html#ae55eec632e369a4afc18e804bae8f3e4">unidir_hack</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00052">52</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae9b50005184bab60e94309c7a30c5c85"></a><!-- doxytag: member="main.c::wait_on_reboot" ref="ae9b50005184bab60e94309c7a30c5c85" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__nl_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00062">62</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a102638bbe37dfc0788ddc7de6afbffe5"></a><!-- doxytag: member="main.c::worb_timer" ref="a102638bbe37dfc0788ddc7de6afbffe5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtimer.html">timer</a> <a class="el" href="NA__nl_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="main_8c_source.html#l00066">66</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="main_8c.html">main.c</a>      </li>

    <li class="footer">Generated on Fri Oct 18 2013 20:34:56 for NETWORK ATTACKS FRAMEWORK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
